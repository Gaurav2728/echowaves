<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>RubyNode</title>
	<link href="style.css" media="all" rel="Stylesheet" type="text/css">
</head>
<body>
<h1>RubyNode</h1>


	<p>RubyNode is a library that allows read only access to Ruby&#8217;s internal <span class="caps">NODE</span>
structure. It can retrieve the node trees of methods and procs and it can use
Ruby&#8217;s parser to parse Ruby source code strings to node trees.</p>


	<p>It provides the class RubyNode, which wraps an internal <span class="caps">NODE</span>. Trees of RubyNode
instances can also be transformed into trees of arrays and hashes (similar to
s-expressions), which are easy to manipulate and work with.</p>


	<p>Sections: <a href="#section1">Requirements</a>, <a href="#section2">Download</a>, <a href="#section3">Installation</a>, <a href="#section4">Usage</a>, <a href="#section5">Feedback</a>, <a href="#section6">Thanks</a>, <a href="#section7">License</a>.</p>


	<h2 id="section1">Requirements</h2>


	<p>RubyNode is tested with Ruby 1.8.4, 1.8.5 and 1.8.6, but it should also work
with other 1.8 versions. RubyNode worked (and still does work) with older Ruby
1.9 snapshots (possibly some node types are not fully supported), but it
currently does not work with the latest 1.9 snapshots and releases.</p>


	<h2 id="section2">Download</h2>


	<ul>
	<li><a href="http://rubyforge.org/projects/rubynode/">Project page</a></li>
		<li><a href="http://rubyforge.org/frs/?group_id=1771">Download</a></li>
	</ul>


	<h2 id="section3">Installation</h2>


	<p>RubyNode generates some of its C source code from Ruby&#8217;s source code, because
the node types and other details differ between Ruby versions.</p>


	<p>For the official releases of Ruby 1.8.4, 1.8.5 and 1.8.6 the needed source
files are included in the package. To compile RubyNode for any other Ruby
version, you will need that version&#8217;s source tar ball extracted somewhere.</p>


	<p>So, for <strong>Ruby 1.8.4</strong>, <strong>1.8.5</strong> and <strong>1.8.6</strong> just run (as root):</p>


<pre><code>gem install rubynode
</code></pre>

	<p>Or if you do not use the gem:</p>


<pre><code>ruby setup.rb
</code></pre>

	<p>That command will compile the C extension and install all files to their
default location (to customize the non-gem installation, please see
<code>"ruby setup.rb --help"</code>)</p>


	<p>For <strong>other Ruby versions</strong> you need to provide the (absolute) path to the source
directory for that Ruby version in the enviroment variable <code>RUBY_SOURCE_DIR</code>.
Example (as root):</p>


<pre><code>RUBY_SOURCE_DIR="/path/to/ruby_source" gem install rubynode
</code></pre>

	<p>Or if you do not use the gem:</p>


<pre><code>RUBY_SOURCE_DIR="/path/to/ruby_source" ruby setup.rb
</code></pre>

	<h2 id="section4">Usage</h2>


	<p>Just <code>require "rubynode"</code> and use it. Here is a short irb sessions that shows
some of the things you can do with RubyNode:</p>


<pre><code>&gt;&gt; require "rubynode" 
=&gt; true
</code></pre>

	<p>Body node of a method:</p>


<pre><code>&gt;&gt; def plus_1(x)
&gt;&gt;   x + 1
&gt;&gt; end
=&gt; nil
&gt;&gt; pp method(:plus_1).body_node.transform
[:scope,
 {:next=&gt;
   [:block,
    [[:args, {:rest=&gt;-1, :cnt=&gt;1, :opt=&gt;false}],
     [:call,
      {:args=&gt;[:array, [[:lit, {:lit=&gt;1}]]],
       :mid=&gt;:+,
       :recv=&gt;[:lvar, {:vid=&gt;:x, :cnt=&gt;2}]}]]],
  :rval=&gt;[:cref, {:next=&gt;false, :clss=&gt;Object}],
  :tbl=&gt;[:x]}]
=&gt; nil
</code></pre>

	<p>Body node and var node of a proc:</p>


<pre><code>&gt;&gt; add_2 = proc { |x| x + 2 }
=&gt; #&lt;Proc:0xb7f24c00@(irb):6&gt;
&gt;&gt; pp add_2.body_node.transform
[:call,
 {:args=&gt;[:array, [[:lit, {:lit=&gt;2}]]], :mid=&gt;:+, :recv=&gt;[:dvar, {:vid=&gt;:x}]}]
=&gt; nil
&gt;&gt; pp add_2.var_node.transform
[:dasgn_curr, {:vid=&gt;:x, :value=&gt;false}]
=&gt; nil
</code></pre>

	<p>Parse a string to nodes:</p>


<pre><code>&gt;&gt; pp "3.times { puts 'Ruby' }".parse_to_nodes.transform
[:iter,
 {:var=&gt;false,
  :iter=&gt;[:call, {:args=&gt;false, :mid=&gt;:times, :recv=&gt;[:lit, {:lit=&gt;3}]}],
  :body=&gt;[:fcall, {:args=&gt;[:array, [[:str, {:lit=&gt;"Ruby"}]]], :mid=&gt;:puts}]}]
=&gt; nil
</code></pre>

	<p>For more details see <a href="api.html"><span class="caps">API</span></a>.</p>


	<p>Have fun!</p>


	<h2 id="section5">Feedback</h2>


	<p>If you find a bug, think that something doesn&#8217;t work as it should or have
other suggestions, then please don&#8217;t hesitate to <a href="mailto:dbatml@remove_nospam.gmx.de">contact
me</a> and tell me about it.</p>


	<h2 id="section6">Thanks</h2>


	<p>I would like to thank Paul Brannan for writing Nodewrap, which inspired me to
write RubyNode and also gave me some ideas and code.</p>


	<h2 id="section7">License</h2>


	<p>Copyright 2006-2007 <a href="mailto:dbatml@remove_nospam.gmx.de">Dominik Bathon</a>.</p>


	<p>RubyNode is licensed under the same terms as Ruby.</p>
</body>
</html>
